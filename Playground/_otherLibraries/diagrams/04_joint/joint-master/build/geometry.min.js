(function(root, factory) {

    if (typeof define === 'function' && define.amd) {

        // AMD. Register as an anonymous module.
        define([], factory);

    } else if (typeof exports === 'object') {

        // Node. Does not work with strict CommonJS, but
        // only CommonJS-like environments that support module.exports,
        // like Node.
        module.exports = factory();

    } else {

        // Browser globals.
        root.g = factory();
    }

}(this, function() {

var g=function(){var a={},b=Math,c=b.abs,d=b.cos,e=b.sin,f=b.sqrt,g=b.min,h=b.max,i=b.atan2,j=b.round,k=b.floor,l=b.PI,m=b.random,n=b.pow;a.bezier={curveThroughPoints:function(a){for(var b=this.getCurveControlPoints(a),c=["M",a[0].x,a[0].y],d=0;d<b[0].length;d++)c.push("C",b[0][d].x,b[0][d].y,b[1][d].x,b[1][d].y,a[d+1].x,a[d+1].y);return c},getCurveControlPoints:function(a){var b,c=[],d=[],e=a.length-1;if(1==e)return c[0]=w((2*a[0].x+a[1].x)/3,(2*a[0].y+a[1].y)/3),d[0]=w(2*c[0].x-a[0].x,2*c[0].y-a[0].y),[c,d];var f=[];for(b=1;b<e-1;b++)f[b]=4*a[b].x+2*a[b+1].x;f[0]=a[0].x+2*a[1].x,f[e-1]=(8*a[e-1].x+a[e].x)/2;var g=this.getFirstControlPoints(f);for(b=1;b<e-1;++b)f[b]=4*a[b].y+2*a[b+1].y;f[0]=a[0].y+2*a[1].y,f[e-1]=(8*a[e-1].y+a[e].y)/2;var h=this.getFirstControlPoints(f);for(b=0;b<e;b++)c.push(w(g[b],h[b])),b<e-1?d.push(w(2*a[b+1].x-g[b+1],2*a[b+1].y-h[b+1])):d.push(w((a[e].x+g[e-1])/2,(a[e].y+h[e-1])/2));return[c,d]},getCurveDivider:function(a,b,c,d){return function(e){var f=q(a,b).pointAt(e),g=q(b,c).pointAt(e),h=q(c,d).pointAt(e),i=q(f,g).pointAt(e),j=q(g,h).pointAt(e),k=q(i,j).pointAt(e);return[{p0:a,p1:f,p2:i,p3:k},{p0:k,p1:j,p2:h,p3:d}]}},getFirstControlPoints:function(a){var b=a.length,c=[],d=[],e=2;c[0]=a[0]/e;for(var f=1;f<b;f++)d[f]=1/e,e=(f<b-1?4:3.5)-d[f],c[f]=(a[f]-c[f-1])/e;for(f=1;f<b;f++)c[b-f-1]-=d[b-f]*c[b-f];return c},getInversionSolver:function(a,b,c,d){function e(a,b){var c=f[a],d=f[b];return function(e){var f=(a%3?3:1)*(b%3?3:1),g=e.x*(c.y-d.y)+e.y*(d.x-c.x)+c.x*d.y-c.y*d.x;return f*g}}var f=arguments;return function(c){var d=3*e(2,3)(b),f=e(1,3)(a)/d,g=-e(2,3)(a)/d,h=f*e(3,1)(c)+g*(e(3,0)(c)+e(2,1)(c))+e(2,0)(c),i=f*e(3,0)(c)+g*e(2,0)(c)+e(1,0)(c);return i/(i-h)}}};var o=a.Curve=function(a,b,c,d){return this instanceof o?a instanceof o?o(a.start,a.controlPoint1,a.controlPoint2,a.end):(this.start=w(a),this.controlPoint1=w(b),this.controlPoint2=w(c),void(this.end=w(d))):new o(a,b,c,d)};o.prototype={bbox:function(){for(var a,b,d,e,i,j,k,l,m=this.start,n=this.controlPoint1,o=this.controlPoint2,p=this.end,q=m.x,r=m.y,s=n.x,t=n.y,u=o.x,v=o.y,w=p.x,y=p.y,z=new Array,A=new Array,B=[new Array,new Array],C=0;C<2;++C)if(0===C?(b=6*q-12*s+6*u,a=-3*q+9*s-9*u+3*w,d=3*s-3*q):(b=6*r-12*t+6*v,a=-3*r+9*t-9*v+3*y,d=3*t-3*r),c(a)<1e-12){if(c(b)<1e-12)continue;e=-d/b,0<e&&e<1&&A.push(e)}else k=b*b-4*d*a,l=f(k),k<0||(i=(-b+l)/(2*a),0<i&&i<1&&A.push(i),j=(-b-l)/(2*a),0<j&&j<1&&A.push(j));for(var D,E,F,G=A.length,H=G;G--;)e=A[G],D=1-e,E=D*D*D*q+3*D*D*e*s+3*D*e*e*u+e*e*e*w,B[0][G]=E,F=D*D*D*r+3*D*D*e*t+3*D*e*e*v+e*e*e*y,B[1][G]=F,z[G]={X:E,Y:F};A[H]=0,A[H+1]=1,z[H]={X:q,Y:r},z[H+1]={X:w,Y:y},B[0][H]=q,B[1][H]=r,B[0][H+1]=w,B[1][H+1]=y,A.length=H+2,B[0].length=H+2,B[1].length=H+2,z.length=H+2;var I=g.apply(null,B[0]),J=g.apply(null,B[1]),K=h.apply(null,B[0]),L=h.apply(null,B[1]);return x(I,J,K-I,L-J)},equals:function(a){return!!a&&this.start.x===a.start.x&&this.start.y===a.start.y&&this.controlPoint1.x===a.controlPoint1.x&&this.controlPoint1.y===a.controlPoint1.y&&this.controlPoint2.x===a.controlPoint2.x&&this.controlPoint2.y===a.controlPoint2.y&&this.end.x===a.end.x&&this.end.y===a.end.y},scale:function(a,b,c){return this.start.scale(a,b,c),this.controlPoint1.scale(a,b,c),this.controlPoint2.scale(a,b,c),this.end.scale(a,b,c),this},translate:function(a,b){return this.start.offset(a,b),this.controlPoint1.offset(a,b),this.controlPoint2.offset(a,b),this.end.offset(a,b),this},toString:function(){return this.type+" "+this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end}};var p=a.Ellipse=function(a,b,c){return this instanceof p?a instanceof p?new p(w(a),a.a,a.b):(a=w(a),this.x=a.x,this.y=a.y,this.a=b,void(this.b=c)):new p(a,b,c)};a.Ellipse.fromRect=function(a){return a=x(a),p(a.center(),a.width/2,a.height/2)},a.Ellipse.prototype={bbox:function(){return x(this.x-this.a,this.y-this.b,2*this.a,2*this.b)},clone:function(){return p(this)},normalizedDistance:function(a){var b=a.x,c=a.y,d=this.a,e=this.b,f=this.x,g=this.y;return(b-f)*(b-f)/(d*d)+(c-g)*(c-g)/(e*e)},inflate:function(a,b){return void 0===a&&(a=0),void 0===b&&(b=a),this.a+=2*a,this.b+=2*b,this},containsPoint:function(a){return this.normalizedDistance(a)<=1},center:function(){return w(this.x,this.y)},tangentTheta:function(b){var c,d,e=30,f=b.x,g=b.y,h=this.a,i=this.b,j=this.bbox().center(),k=j.x,l=j.y,m=f>j.x+h/2,n=f<j.x-h/2;return m||n?(c=f>j.x?g-e:g+e,d=h*h/(f-k)-h*h*(g-l)*(c-l)/(i*i*(f-k))+k):(d=g>j.y?f+e:f-e,c=i*i/(g-l)-i*i*(f-k)*(d-k)/(h*h*(g-l))+l),a.point(d,c).theta(b)},equals:function(a){return!!a&&a.x===this.x&&a.y===this.y&&a.a===this.a&&a.b===this.b},intersectionWithLineFromCenterToPoint:function(a,b){a=w(a),b&&a.rotate(w(this.x,this.y),b);var c,d=a.x-this.x,e=a.y-this.y;if(0===d)return c=this.bbox().pointNearestToPoint(a),b?c.rotate(w(this.x,this.y),-b):c;var g=e/d,h=g*g,i=this.a*this.a,j=this.b*this.b,k=f(1/(1/i+h/j));k=d<0?-k:k;var l=g*k;return c=w(this.x+k,this.y+l),b?c.rotate(w(this.x,this.y),-b):c},toString:function(){return w(this.x,this.y).toString()+" "+this.a+" "+this.b}};var q=a.Line=function(a,b){return this instanceof q?a instanceof q?q(a.start,a.end):(this.start=w(a),void(this.end=w(b))):new q(a,b)};a.Line.prototype={bbox:function(){var a=g(this.start.x,this.end.x),b=g(this.start.y,this.end.y),c=h(this.start.x,this.end.x),d=h(this.start.y,this.end.y);return x(a,b,c-a,d-b)},bearing:function(){var a=C(this.start.y),b=C(this.end.y),c=this.start.x,f=this.end.x,g=C(f-c),h=e(g)*d(b),j=d(a)*e(b)-e(a)*d(b)*d(g),k=B(i(h,j)),l=["NE","E","SE","S","SW","W","NW","N"],m=k-22.5;return m<0&&(m+=360),m=parseInt(m/45),l[m]},clone:function(){return q(this.start,this.end)},equals:function(a){return!!a&&this.start.x===a.start.x&&this.start.y===a.start.y&&this.end.x===a.end.x&&this.end.y===a.end.y},intersect:function(a){if(a instanceof q){var b=w(this.end.x-this.start.x,this.end.y-this.start.y),c=w(a.end.x-a.start.x,a.end.y-a.start.y),d=b.x*c.y-b.y*c.x,e=w(a.start.x-this.start.x,a.start.y-this.start.y),f=e.x*c.y-e.y*c.x,g=e.x*b.y-e.y*b.x;if(0===d||f*d<0||g*d<0)return null;if(d>0){if(f>d||g>d)return null}else if(f<d||g<d)return null;return w(this.start.x+f*b.x/d,this.start.y+f*b.y/d)}if(a instanceof x){var h,i,j=a,k=[j.topLine(),j.rightLine(),j.bottomLine(),j.leftLine()],l=[],m=[];for(i=0;i<k.length;i++)h=this.intersect(k[i]),null!==h&&m.indexOf(h.toString())<0&&(l.push(h),m.push(h.toString()));return l.length>0?l:null}return null},length:function(){return f(this.squaredLength())},midpoint:function(){return w((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)},pointAt:function(a){var b=(1-a)*this.start.x+a*this.end.x,c=(1-a)*this.start.y+a*this.end.y;return w(b,c)},pointOffset:function(a){return((this.end.x-this.start.x)*(a.y-this.start.y)-(this.end.y-this.start.y)*(a.x-this.start.x))/2},scale:function(a,b,c){return this.start.scale(a,b,c),this.end.scale(a,b,c),this},translate:function(a,b){return this.start.offset(a,b),this.end.offset(a,b),this},vector:function(){return w(this.end.x-this.start.x,this.end.y-this.start.y)},closestPoint:function(a){return this.pointAt(this.closestPointNormalizedLength(a))},closestPointNormalizedLength:function(a){var b=this.vector().dot(q(this.start,a).vector());return Math.min(1,Math.max(0,b/this.squaredLength()))},squaredLength:function(){var a=this.start.x,b=this.start.y,c=this.end.x,d=this.end.y;return(a-=c)*a+(b-=d)*b},toString:function(){return this.start.toString()+" "+this.end.toString()}},a.Line.prototype.intersection=a.Line.prototype.intersect;var r=a.Path=function(a){return this instanceof r?"string"==typeof a?r.parse(a):void(this.pathSegments=a):new r(a)};r.parse=function(a){var b=[];a=a||"M 0 0";for(var c,d,e=a.split(new RegExp(" (?=[a-zA-Z])")),f=0,g=e.length;f<g;f++){var h=e[f],i=h.split(" "),j=i.shift(),k=r.segments[j].fromCoords(i,c,d);b.push(k),c=k,k.recordSubpathStartSegment&&(d=k)}return new r(b)},r.prototype={bbox:function(){for(var a,b,c=this.pathSegments,d=c.length,e=0;e<d;e++){var f=c[e];if(f.recordSubpathStartSegment&&(b=f),f.recordBBox){var g=f.bbox();a=a?a.union(g):g}}return a?a:x(b.end.x,b.end.y,0,0)},clone:function(){return r(this.serialize())},equals:function(a){if(!a)return!1;var b=this.pathSegments,c=b.length;if(b&&a.pathSegments&&a.pathSegments.length!==c)return!1;for(var d=0;d<c;d++){var e=b[d],f=a.pathSegments[d];if(e.type!==f.type||!e.equals(f))return!1}return!0},scale:function(a,b,c){for(var d=this.pathSegments,e=d.length,f=0;f<e;f++){var g=d[f];g.scale(a,b,c)}return this},translate:function(a,b){for(var c=this.pathSegments,d=c.length,e=0;e<d;e++){var f=c[e];f.translate(a,b)}return this},serialize:function(){for(var a="",b=this.pathSegments,c=b.length,d=0;d<c;d++){var e=b[d];a+=e.serialize()+" "}return a.trim()}},r.prototype.toString=r.prototype.serialize;var s=function(a,b){return this instanceof s?a instanceof s?s(a.start,a.end):a instanceof q?s(a.start,a.end):(this.start=w(a),void(this.end=w(b))):new s(a,b)};s.fromCoords=function(a,b,c){if(2!==a.length)throw new Error("Wrong number of coordinates provided (expects 2).");if(!b)throw new Error("No previous segment provided (path must start with a moveto segment).");var d=w(b.end),e=w(+a[0],+a[1]);return s(d,e)},s.prototype={bbox:q.prototype.bbox,equals:q.prototype.equals,recordBBox:!0,scale:q.prototype.scale,translate:q.prototype.translate,type:"L",serialize:function(){var a=this.end;return this.type+" "+a.x+" "+a.y},toString:function(){return this.type+" "+this.start+" "+this.end}};var t=function(a,b,c,d){return this instanceof t?a instanceof t?t(a.start,a.controlPoint1,a.controlPoint2,a.end):a instanceof o?t(a.start,a.controlPoint1,a.controlPoint2,a.end):(this.start=w(a),this.controlPoint1=w(b),this.controlPoint2=w(c),void(this.end=w(d))):new t(a,b,c,d)};t.fromCoords=function(a,b,c){if(6!==a.length)throw new Error("Wrong number of coordinates provided (expects 6).");if(!b)throw new Error("No previous segment provided (path must start with a moveto segment).");var d=w(b.end),e=w(+a[0],+a[1]),f=w(+a[2],+a[3]),g=w(+a[4],+a[5]);return t(d,e,f,g)},t.prototype={bbox:o.prototype.bbox,equals:o.prototype.equals,recordBBox:!0,scale:o.prototype.scale,translate:o.prototype.translate,type:"C",serialize:function(){var a=this.controlPoint1,b=this.controlPoint2,c=this.end;return this.type+" "+a.x+" "+a.y+" "+b.x+" "+b.y+" "+c.x+" "+c.y},toString:function(){return this.type+" "+this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end}};var u=function(a,b){return this instanceof u?a instanceof u?u(a.start,a.end):a instanceof q?u(a.start,a.end):(this.start=w(a),void(this.end=w(b))):new u(a,b)};u.fromCoords=function(a,b,c){if(2!==a.length)throw new Error("Wrong number of coordinates provided (expects 2).");var d=b?w(b.end):w(0,0),e=w(+a[0],+a[1]);return u(d,e)},u.prototype={bbox:function(){return null},equals:q.prototype.equals,recordSubpathStartSegment:!0,scale:q.prototype.scale,translate:q.prototype.translate,type:"M",serialize:function(){var a=this.end;return this.type+" "+a.x+" "+a.y},toString:function(){return this.type+" "+this.start+" "+this.end}};var v=function(a,b){return this instanceof v?a instanceof v?v(a.start,a.end):a instanceof q?u(a.start,a.end):(this.start=w(a),void(this.end=w(b))):new v(a,b)};v.fromCoords=function(a,b,c){if(0!==a.length)throw new Error("Wrong number of coordinates provided (expects 0).");if(!b)throw new Error("No previous segment provided (path must start with a moveto segment).");if(!c)throw new Error("No subpath start segment provided (path must start with a moveto segment).");var d=w(b.end),e=w(c.end);return v(d,e)},v.prototype={bbox:q.prototype.bbox,equals:q.prototype.equals,scale:q.prototype.scale,translate:q.prototype.translate,type:"Z",serialize:function(){return this.type},toString:function(){return this.type+" "+this.start+" "+this.end}},r.segments={L:s,C:t,M:u,Z:v};var w=a.Point=function(a,b){if(!(this instanceof w))return new w(a,b);if("string"==typeof a){var c=a.split(a.indexOf("@")===-1?" ":"@");a=parseInt(c[0],10),b=parseInt(c[1],10)}else Object(a)===a&&(b=a.y,a=a.x);this.x=void 0===a?0:a,this.y=void 0===b?0:b};a.Point.fromPolar=function(a,b,f){f=f&&w(f)||w(0,0);var g=c(a*d(b)),h=c(a*e(b)),i=z(B(b));return i<90?h=-h:i<180?(g=-g,h=-h):i<270&&(g=-g),w(f.x+g,f.y+h)},a.Point.random=function(a,b,c,d){return w(k(m()*(b-a+1)+a),k(m()*(d-c+1)+c))},a.Point.prototype={adhereToRect:function(a){return a.containsPoint(this)?this:(this.x=g(h(this.x,a.x),a.x+a.width),this.y=g(h(this.y,a.y),a.y+a.height),this)},bearing:function(a){return q(this,a).bearing()},changeInAngle:function(a,b,c){return w(this).offset(-a,-b).theta(c)-this.theta(c)},clone:function(){return w(this)},difference:function(a,b){return Object(a)===a&&(b=a.y,a=a.x),w(this.x-(a||0),this.y-(b||0))},distance:function(a){return q(this,a).length()},squaredDistance:function(a){return q(this,a).squaredLength()},equals:function(a){return!!a&&this.x===a.x&&this.y===a.y},magnitude:function(){return f(this.x*this.x+this.y*this.y)||.01},manhattanDistance:function(a){return c(a.x-this.x)+c(a.y-this.y)},move:function(a,b){var c=C(w(a).theta(this));return this.offset(d(c)*b,-e(c)*b)},normalize:function(a){var b=(a||1)/this.magnitude();return this.scale(b,b)},offset:function(a,b){return Object(a)===a&&(b=a.y,a=a.x),this.x+=a||0,this.y+=b||0,this},reflection:function(a){return w(a).move(this,this.distance(a))},rotate:function(a,b){b=(b+360)%360,this.toPolar(a),this.y+=C(b);var c=w.fromPolar(this.x,this.y,a);return this.x=c.x,this.y=c.y,this},round:function(a){var b=n(10,a||0);return this.x=j(this.x*b)/b,this.y=j(this.y*b)/b,this},scale:function(a,b,c){return c=c&&w(c)||w(0,0),this.x=c.x+a*(this.x-c.x),this.y=c.y+b*(this.y-c.y),this},snapToGrid:function(a,b){return this.x=A(this.x,a),this.y=A(this.y,b||a),this},theta:function(a){a=w(a);var b=-(a.y-this.y),c=a.x-this.x,d=i(b,c);return d<0&&(d=2*l+d),180*d/l},angleBetween:function(a,b){var c=this.equals(a)||this.equals(b)?NaN:this.theta(b)-this.theta(a);return c<0&&(c+=360),c},vectorAngle:function(a){var b=w(0,0);return b.angleBetween(this,a)},toJSON:function(){return{x:this.x,y:this.y}},toPolar:function(a){a=a&&w(a)||w(0,0);var b=this.x,c=this.y;return this.x=f((b-a.x)*(b-a.x)+(c-a.y)*(c-a.y)),this.y=C(a.theta(w(b,c))),this},toString:function(){return this.x+"@"+this.y},update:function(a,b){return this.x=a||0,this.y=b||0,this},dot:function(a){return a?this.x*a.x+this.y*a.y:NaN},cross:function(a,b){return a&&b?(b.x-this.x)*(a.y-this.y)-(b.y-this.y)*(a.x-this.x):NaN}};var x=a.Rect=function(a,b,c,d){return this instanceof x?(Object(a)===a&&(b=a.y,c=a.width,d=a.height,a=a.x),this.x=void 0===a?0:a,this.y=void 0===b?0:b,this.width=void 0===c?0:c,void(this.height=void 0===d?0:d)):new x(a,b,c,d)};a.Rect.fromEllipse=function(a){return a=p(a),x(a.x-a.a,a.y-a.b,2*a.a,2*a.b)},a.Rect.prototype={bbox:function(a){if(!a)return this.clone();var b=C(a||0),f=c(e(b)),g=c(d(b)),h=this.width*g+this.height*f,i=this.width*f+this.height*g;return x(this.x+(this.width-h)/2,this.y+(this.height-i)/2,h,i)},bottomLeft:function(){return w(this.x,this.y+this.height)},bottomLine:function(){return q(this.bottomLeft(),this.corner())},bottomMiddle:function(){return w(this.x+this.width/2,this.y+this.height)},center:function(){return w(this.x+this.width/2,this.y+this.height/2)},clone:function(){return x(this)},containsPoint:function(a){return a=w(a),a.x>=this.x&&a.x<=this.x+this.width&&a.y>=this.y&&a.y<=this.y+this.height},containsRect:function(a){var b=x(this).normalize(),c=x(a).normalize(),d=b.width,e=b.height,f=c.width,g=c.height;if(!(d&&e&&f&&g))return!1;var h=b.x,i=b.y,j=c.x,k=c.y;return f+=j,d+=h,g+=k,e+=i,h<=j&&f<=d&&i<=k&&g<=e},corner:function(){return w(this.x+this.width,this.y+this.height)},equals:function(a){var b=x(this).normalize(),c=x(a).normalize();return b.x===c.x&&b.y===c.y&&b.width===c.width&&b.height===c.height},intersect:function(a){var b=this.origin(),c=this.corner(),d=a.origin(),e=a.corner();if(e.x<=b.x||e.y<=b.y||d.x>=c.x||d.y>=c.y)return null;var f=Math.max(b.x,d.x),g=Math.max(b.y,d.y);return x(f,g,Math.min(c.x,e.x)-f,Math.min(c.y,e.y)-g)},intersectionWithLineFromCenterToPoint:function(a,b){a=w(a);var c,d=w(this.x+this.width/2,this.y+this.height/2);b&&a.rotate(d,b);for(var e=[q(this.origin(),this.topRight()),q(this.topRight(),this.corner()),q(this.corner(),this.bottomLeft()),q(this.bottomLeft(),this.origin())],f=q(d,a),g=e.length-1;g>=0;--g){var h=e[g].intersection(f);if(null!==h){c=h;break}}return c&&b&&c.rotate(d,-b),c},leftLine:function(){return q(this.origin(),this.bottomLeft())},leftMiddle:function(){return w(this.x,this.y+this.height/2)},moveAndExpand:function(a){return this.x+=a.x||0,this.y+=a.y||0,this.width+=a.width||0,this.height+=a.height||0,this},offset:function(a,b){return w.prototype.offset.call(this,a,b)},inflate:function(a,b){return void 0===a&&(a=0),void 0===b&&(b=a),this.x-=a,this.y-=b,this.width+=2*a,this.height+=2*b,this},normalize:function(){var a=this.x,b=this.y,c=this.width,d=this.height;return this.width<0&&(a=this.x+this.width,c=-this.width),this.height<0&&(b=this.y+this.height,d=-this.height),this.x=a,this.y=b,this.width=c,this.height=d,this},origin:function(){return w(this.x,this.y)},pointNearestToPoint:function(a){if(a=w(a),this.containsPoint(a)){var b=this.sideNearestToPoint(a);switch(b){case"right":return w(this.x+this.width,a.y);case"left":return w(this.x,a.y);case"bottom":return w(a.x,this.y+this.height);case"top":return w(a.x,this.y)}}return a.adhereToRect(this)},rightLine:function(){return q(this.topRight(),this.corner())},rightMiddle:function(){return w(this.x+this.width,this.y+this.height/2)},round:function(a){var b=n(10,a||0);return this.x=j(this.x*b)/b,this.y=j(this.y*b)/b,this.width=j(this.width*b)/b,this.height=j(this.height*b)/b,this},scale:function(a,b,c){return c=this.origin().scale(a,b,c),this.x=c.x,this.y=c.y,this.width*=a,this.height*=b,this},maxRectScaleToFit:function(b,c){b=a.Rect(b),c||(c=b.center());var d,e,f,g,h,i,j,k,l=c.x,m=c.y;d=e=f=g=h=i=j=k=1/0;var n=b.origin();n.x<l&&(d=(this.x-l)/(n.x-l)),n.y<m&&(h=(this.y-m)/(n.y-m));var o=b.corner();o.x>l&&(e=(this.x+this.width-l)/(o.x-l)),o.y>m&&(i=(this.y+this.height-m)/(o.y-m));var p=b.topRight();p.x>l&&(f=(this.x+this.width-l)/(p.x-l)),p.y<m&&(j=(this.y-m)/(p.y-m));var q=b.bottomLeft();return q.x<l&&(g=(this.x-l)/(q.x-l)),q.y>m&&(k=(this.y+this.height-m)/(q.y-m)),{sx:Math.min(d,e,f,g),sy:Math.min(h,i,j,k)}},maxRectUniformScaleToFit:function(a,b){var c=this.maxRectScaleToFit(a,b);return Math.min(c.sx,c.sy)},sideNearestToPoint:function(a){a=w(a);var b=a.x-this.x,c=this.x+this.width-a.x,d=a.y-this.y,e=this.y+this.height-a.y,f=b,g="left";return c<f&&(f=c,g="right"),d<f&&(f=d,g="top"),e<f&&(f=e,g="bottom"),g},snapToGrid:function(a,b){var c=this.origin().snapToGrid(a,b),d=this.corner().snapToGrid(a,b);return this.x=c.x,this.y=c.y,this.width=d.x-c.x,this.height=d.y-c.y,this},topLine:function(){return q(this.origin(),this.topRight())},topMiddle:function(){return w(this.x+this.width/2,this.y)},topRight:function(){return w(this.x+this.width,this.y)},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},toString:function(){return this.origin().toString()+" "+this.corner().toString()},union:function(a){a=x(a);var b=this.origin(),c=this.corner(),d=a.origin(),e=a.corner(),f=Math.min(b.x,d.x),g=Math.min(b.y,d.y),h=Math.max(c.x,e.x),i=Math.max(c.y,e.y);return x(f,g,h-f,i-g)}};var y=a.Polyline=function(a){return this instanceof y?"string"==typeof a?new y.parse(a):void(this.points=Array.isArray(a)?a.map(w):[]):new y(a)};y.parse=function(a){for(var b=[],c=a.split(/\s|,/),d=0,e=c.length;d<e;d+=2)b.push({x:+c[d],y:+c[d+1]});return y(b)},y.prototype={bbox:function(){var a=1/0,b=-(1/0),c=1/0,d=-(1/0),e=this.points,f=e.length;if(0===f)return null;for(var g=0;g<f;g++){var h=e[g],i=h.x,j=h.y;i<a&&(a=i),i>b&&(b=i),j<c&&(c=j),j>d&&(d=j)}return x(a,c,b-a,d-c)},clone:function(){return new y(this.points)},pointAtLength:function(a){for(var b=this.points,c=0,d=0,e=b.length-1;d<e;d++){var f=b[d],g=b[d+1],h=f.distance(g);if(c+=h,a<=c)return q(g,f).pointAt(h?(c-a)/h:0)}return null},length:function(){for(var a=this.points,b=0,c=0,d=a.length-1;c<d;c++)b+=a[c].distance(a[c+1]);return b},closestPoint:function(a){return this.pointAtLength(this.closestPointLength(a))},closestPointLength:function(a){for(var b,c=this.points,d=1/0,e=0,f=0,g=c.length-1;f<g;f++){var h=q(c[f],c[f+1]),i=h.length(),j=h.closestPointNormalizedLength(a),k=h.pointAt(j),l=k.squaredDistance(a);l<d&&(d=l,b=e+j*i),e+=i}return b},toString:function(){return this.points+""},convexHull:function(){var a,b,c,d=this.points;for(b=d.length,a=0;a<b;a++)void 0===c?c=d[a]:d[a].y<c.y?c=d[a]:d[a].y===c.y&&d[a].x>c.x&&(c=d[a]);var e=[];for(b=d.length,a=0;a<b;a++){var f=c.theta(d[a]);0===f&&(f=360);var g=[d[a],a,f];e.push(g)}if(e.sort(function(a,b){var c=a[2]-b[2];return 0===c&&(c=b[1]-a[1]),c}),e.length>2){var h=e[e.length-1];e.unshift(h)}for(var i,j,k,l,m,n,o={},p=[];0!==e.length;)if(i=e.pop(),j=i[0],!o.hasOwnProperty(i[0]+"@@"+i[1]))for(var q=!1;!q;)if(p.length<2)p.push(i),q=!0;else{k=p.pop(),l=k[0],m=p.pop(),n=m[0];var r=n.cross(l,j);if(r<0)p.push(m),p.push(k),p.push(i),q=!0;else if(0===r){var s=1e-10,t=l.angleBetween(n,j);Math.abs(t-180)<s?(o[k[0]+"@@"+k[1]]=l,p.push(m)):l.equals(j)||n.equals(l)?(o[k[0]+"@@"+k[1]]=l,p.push(m)):Math.abs((t+1)%360-1)<s&&(p.push(m),e.push(k))}else o[k[0]+"@@"+k[1]]=l,p.push(m)}p.length>2&&p.pop();var u,v=-1;for(b=p.length,a=0;a<b;a++){var w=p[a][1];(void 0===u||w<u)&&(u=w,v=a)}var x=[];if(v>0){var z=p.slice(v),A=p.slice(0,v);x=z.concat(A)}else x=p;var B=[];for(b=x.length,a=0;a<b;a++)B.push(x[a][0]);return y(B)},scale:function(a,b,c){for(var d=this.points,e=0,f=d.length;e<f;e++)d[e].scale(a,b,c);return this},translate:function(a,b){for(var c=this.points,d=0,e=c.length;d<e;d++)c[d].offset(a,b);return this},serialize:function(){for(var a="",b=this.points,c=0,d=b.length;c<d;c++){var e=b[c];a+=e.x+","+e.y+" "}return a.trim()}},a.scale={linear:function(a,b,c){var d=a[1]-a[0],e=b[1]-b[0];return(c-a[0])/d*e+b[0]||0}};var z=a.normalizeAngle=function(a){return a%360+(a<0?360:0)},A=a.snapToGrid=function(a,b){return b*Math.round(a/b)},B=a.toDeg=function(a){return 180*a/l%360},C=a.toRad=function(a,b){return b=b||!1,a=b?a:a%360,a*l/180};return a.ellipse=a.Ellipse,a.line=a.Line,a.point=a.Point,a.rect=a.Rect,a}();

    return g;

}));
